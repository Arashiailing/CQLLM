```ql
import python

/**
 * CWE-22: Path Injection
 * This query detects instances where user input is directly used in file path expressions.
 */

from File file, Call call, Expr userInputExpr
where call.getTarget().getName() = "open" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expanduser" or
      call.getTarget().getName() = "os.path.expandvars" or
      call.getTarget().getName() = "os.path.commonpath" or
      call.getTarget().getName() = "os.path.samefile" or
      call.getTarget().getName() = "os.path.ismount" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expanduser" or
      call.getTarget().getName() = "os.path.expandvars" or
      call.getTarget().getName() = "os.path.commonpath" or
      call.getTarget().getName() = "os.path.samefile" or
      call.getTarget().getName() = "os.path.ismount" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expanduser" or
      call.getTarget().getName() = "os.path.expandvars" or
      call.getTarget().getName() = "os.path.commonpath" or
      call.getTarget().getName() = "os.path.samefile" or
      call.getTarget().getName() = "os.path.ismount" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expanduser" or
      call.getTarget().getName() = "os.path.expandvars" or
      call.getTarget().getName() = "os.path.commonpath" or
      call.getTarget().getName() = "os.path.samefile" or
      call.getTarget().getName() = "os.path.ismount" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expanduser" or
      call.getTarget().getName() = "os.path.expandvars" or
      call.getTarget().getName() = "os.path.commonpath" or
      call.getTarget().getName() = "os.path.samefile" or
      call.getTarget().getName() = "os.path.ismount" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expanduser" or
      call.getTarget().getName() = "os.path.expandvars" or
      call.getTarget().getName() = "os.path.commonpath" or
      call.getTarget().getName() = "os.path.samefile" or
      call.getTarget().getName() = "os.path.ismount" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expanduser" or
      call.getTarget().getName() = "os.path.expandvars" or
      call.getTarget().getName() = "os.path.commonpath" or
      call.getTarget().getName() = "os.path.samefile" or
      call.getTarget().getName() = "os.path.ismount" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expanduser" or
      call.getTarget().getName() = "os.path.expandvars" or
      call.getTarget().getName() = "os.path.commonpath" or
      call.getTarget().getName() = "os.path.samefile" or
      call.getTarget().getName() = "os.path.ismount" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expanduser" or
      call.getTarget().getName() = "os.path.expandvars" or
      call.getTarget().getName() = "os.path.commonpath" or
      call.getTarget().getName() = "os.path.samefile" or
      call.getTarget().getName() = "os.path.ismount" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expanduser" or
      call.getTarget().getName() = "os.path.expandvars" or
      call.getTarget().getName() = "os.path.commonpath" or
      call.getTarget().getName() = "os.path.samefile" or
      call.getTarget().getName() = "os.path.ismount" or
      call.getTarget().getName() = "os.path.exists" or
      call.getTarget().getName() = "os.path.isfile" or
      call.getTarget().getName() = "os.path.isdir" or
      call.getTarget().getName() = "os.listdir" or
      call.getTarget().getName() = "os.remove" or
      call.getTarget().getName() = "os.rename" or
      call.getTarget().getName() = "os.rmdir" or
      call.getTarget().getName() = "os.makedirs" or
      call.getTarget().getName() = "os.removedirs" or
      call.getTarget().getName() = "os.stat" or
      call.getTarget().getName() = "os.path.join" or
      call.getTarget().getName() = "os.path.split" or
      call.getTarget().getName() = "os.path.abspath" or
      call.getTarget().getName() = "os.path.relpath" or
      call.getTarget().getName() = "os.path.commonprefix" or
      call.getTarget().getName() = "os.path.getsize" or
      call.getTarget().getName() = "os.path.getmtime" or
      call.getTarget().getName() = "os.path.getatime" or
      call.getTarget().getName() = "os.path.getctime" or
      call.getTarget().getName() = "os.path.islink" or
      call.getTarget().getName() = "os.path.realpath" or
      call.getTarget().getName() = "os.path.expand