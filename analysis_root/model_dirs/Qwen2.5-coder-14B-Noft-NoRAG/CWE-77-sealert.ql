```ql
import python

/**
 * This query detects potential command injection vulnerabilities
 * by identifying instances where user input is used to construct
 * shell commands without proper sanitization.
 */
from ProcessBuilder pb, Call call, Expr inputExpr
where
  // Check if the call is to a method that constructs a shell command
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "os.system" or
  call.getTarget().getName() = "os.popen" or
  call.getTarget().getName() = "os.exec" or
  call.getTarget().getName() = "os.spawn" or
  call.getTarget().getName() = "os.startfile" or
  call.getTarget().getName() = "shlex.split" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget().getName() = "subprocess.check_output" or
  call.getTarget().getName() = "subprocess.call" or
  call.getTarget().getName() = "subprocess.run" or
  call.getTarget().getName() = "subprocess.Popen" or
  call.getTarget().getName() = "subprocess.check_call" or
  call.getTarget