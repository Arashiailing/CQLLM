/** * @name Improper link resolution before file access ('Link Following') * @description Insecure file access patterns where links are resolved improperly before being accessed may lead to security vulnerabilities. * @kind path-problem * @problem.severity error * @security-severity 7.5 * @sub-severity high * @precision medium * @id py/chroot * @tags security *       external/cwe/cwe-059 */import pythonimport semmle.python.security.dataflow.PathInjectionQueryimport PathInjectionFlow::PathGraphfrom PathInjectionFlow::PathNode source, PathInjectionFlow::PathNode sinkwhere PathInjectionFlow::flowPath(source, sink)select sink.getNode(), source, sink, "This path depends on a $@.", source.getNode(), "user-supplied value"