/** * @name CWE-59: Improper Link Resolution Before File Access ('Link Following') * @description This query detects improper link resolution before file access operations, which could lead to security vulnerabilities. * @kind path-problem * @problem.severity error * @security-severity 7.8 * @id py/keycloak_cli * @tags security *       external/cwe/cwe-059 */import pythonimport external.VCSimport semmle.python.security.dataflow.FileAccessQueryimport semmle.python.security.dataflow.TaintTrackingimport semmle.python.security.dataflow.new.internal.IOBindingimport semmle.python.security.dataflow.new.internal.DataFlowimport semmle.python.security.dataflow.new.internal.WindowsPathimport semmle.python.security.dataflow.new.WindowsPathGuardsimport semmle.python.security.dataflow.new.RemoteFlowprivate import semmle.python.security.dataflow.new.internal.RemoteModuleprivate import semmle.python.security.dataflow.new.RemoteToLocalFlowprivate import semmle.python.security.dataflow.new.WindowsPathGuardsprivate import semmle.python.security.dataflow.new.WindowsPathAnalysis// 定义数据流源节点和汇节点的变量source和sinkfrom PathInjectionFlow::PathNode source, PathInjectionFlow::PathNode sink// 条件：如果存在从源到汇点的路径流动where PathInjectionFlow::flowPath(source, sink)// 选择汇节点、源节点、汇节点，并生成警告信息select sink.getNode(), source, sink, "This path depends on a $@.", source.getNode(),  "user-supplied value"