/** * @name CWE-203: Observable Discrepancy * @description The discrepancy between observable behavior and internal state may cause inconsistencies in a system. * @kind problem * @problem.severity warning * @precision medium * @id py/websocket */import python// 导入WebSocket相关的查询模块import semmle.python.security.dataflow.WebSocketQuery// 导入路径图类，用于表示数据流路径import WebSocketFlow::PathGraph// 从路径图中选择源节点和汇节点from WebSocketFlow::PathNode source, WebSocketFlow::PathNode sink// 条件：存在从源节点到汇节点的数据流路径where WebSocketFlow::flowPath(source, sink)// 选择结果：汇节点、源节点、路径信息、描述信息等select sink.getNode(), source, sink, "Observable discrepancy detected at $@.", source.getNode(),  "internal state"